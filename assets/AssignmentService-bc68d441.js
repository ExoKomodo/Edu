import{d as k,u as M,b as P,m as f,j as d,o as c,f as m,n as A,v as E,a,t as w,g as h,l as T,p as V,C as b,k as y,q as U,F as C,h as I,i as q,A as u,H as g}from"./index-3fc7e24a.js";import{S as F}from"./SectionService-1dd80d0f.js";import{B as $}from"./BlobService-b6957b08.js";const N={key:0,class:"bg-mysticStone text-white border-slate-400 border-2 rounded p-1 pl-2 my-2"},B=a("div",{class:"text-2xl"},"Assignment Editor",-1),D={for:"edit-mode"},H=a("label",{for:"show-preview"}," Show preview?",-1),L={key:0},z=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-12"},"Name",-1),j={key:0,class:"text-2xl font-bold border-slate-400 rounded border-2 p-1 pl-2"},R=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 p my-2 mr-1"},"Short Description",-1),Z={key:1,class:"text-xl border-slate-400 rounded border-2 p-1 pl-2 my-2"},G=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-8"},"Problem Explanation",-1),J=["innerHTML"],K=a("label",{for:"required-sections"},"Choose required sections:",-1),O=["value"],Q=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-12"},"Id",-1),te=k({__name:"AssignmentEditor",props:{handler:{type:Function},handlerText:{},assignmentId:{},assignmentName:{},assignmentDescription:{},assignmentProblemExplanation:{},assignmentSectionIds:{}},async setup(x){let t,n;const s=q(),i=M(),l=x,e=P({isEditMode:!1,showPreview:!1,id:l.assignmentId,name:l.assignmentName,description:l.assignmentDescription,problemExplanation:l.assignmentProblemExplanation,requiredSectionIds:l.assignmentSectionIds}),v=([t,n]=f(async()=>F.getAllAsync({toast:i,token:([t,n]=f(()=>u.getAccessTokenAsync(s,{toast:i})),t=await t,n(),t)})),t=await t,n(),t);function W(p){return p}return(p,r)=>{var _;return d(u).isAdmin(d(s))?(c(),m("div",N,[B,A(a("input",{type:"checkbox",id:"edit-mode",name:"editMode","onUpdate:modelValue":r[0]||(r[0]=o=>e.isEditMode=o)},null,512),[[E,e.isEditMode]]),a("label",D,w(p.handlerText)+" mode?",1),a("span",{class:V(["inline-block",{invisible:!e.isEditMode}])},[h(T,{handler:()=>p.handler(e),text:p.handlerText},null,8,["handler","text"])],2),a("div",{class:V({invisible:!e.isEditMode})},[A(a("input",{type:"checkbox",id:"show-preview",name:"showPreview","onUpdate:modelValue":r[1]||(r[1]=o=>e.showPreview=o)},null,512),[[E,e.showPreview]]),H],2),d(u).isAdmin(d(s))&&e.isEditMode?(c(),m("div",L,[z,h(b,{modelValue:e.name,"onUpdate:modelValue":r[2]||(r[2]=o=>e.name=o),height:2},null,8,["modelValue"]),d(u).isAdmin(d(s))&&e.isEditMode&&e.showPreview?(c(),m("p",j,w((_=e.name)==null?void 0:_.toUpperCase()),1)):y("",!0),R,h(b,{modelValue:e.description,"onUpdate:modelValue":r[3]||(r[3]=o=>e.description=o),height:2},null,8,["modelValue"]),d(u).isAdmin(d(s))&&e.isEditMode&&e.showPreview?(c(),m("p",Z,w(e.description),1)):y("",!0),G,h(b,{modelValue:e.problemExplanation,"onUpdate:modelValue":r[4]||(r[4]=o=>e.problemExplanation=o),language:"html",height:40},null,8,["modelValue"]),d(u).isAdmin(d(s))&&e.isEditMode&&e.showPreview?(c(),m("div",{key:2,class:"text-xl border-slate-400 rounded border-2 p-1 pl-2 my-2",innerHTML:e.problemExplanation},null,8,J)):y("",!0),a("div",null,[K,A(a("select",{id:"required-sections",name:"required-sections",class:"h-10","onUpdate:modelValue":r[5]||(r[5]=o=>e.requiredSectionIds=o),multiple:""},[(c(!0),m(C,null,I(d(v),(o,S)=>(c(),m("option",{value:S,class:"text-black"},w(o.name),9,O))),256))],512),[[U,e.requiredSectionIds]])]),Q,h(b,{modelValue:e.id,"onUpdate:modelValue":r[6]||(r[6]=o=>e.id=o),height:2},null,8,["modelValue"])])):y("",!0)])):y("",!0)}}});class se{static async createAsync(t,n={}){var s;try{return await g.postAsync("assignment",t,n)}catch(i){throw(s=n.toast)==null||s.error(`Failed to create assignment: ${i}`),i}}static async deleteAsync(t,n={}){var s;try{return await g.deleteAsync("assignment",t,n)}catch(i){throw(s=n.toast)==null||s.error(`Failed to delete assignment: ${i}`),i}}static async fillTemplateAsync(t,n={}){if(!t)return"";const s=/"\${([0-9a-zA-Z_\-\/\.]+)}"/g,i=new Map;for(let l of t.matchAll(s)){const e=l[0],v=l[1];e in i||i.set(e,await $.getPresignedUrlAsync(v,n))}for(let[l,e]of i)t=t.replace(l,e);return t}static async getAsync(t,n={}){var s;try{return await g.getAsync("assignment",t,n)}catch(i){throw(s=n.toast)==null||s.error(`Failed to get assignment: ${i}`),i}}static async getAllAsync(t={}){var n;try{return await g.getAllAsync("assignment",t)}catch(s){throw(n=t.toast)==null||n.error(`Failed to get all assignments: ${s}`),s}}static async updateAsync(t,n={}){var s;try{return await g.putAsync("assignment",t,n)}catch(i){throw(s=n.toast)==null||s.error(`Failed to update assignment: ${i}`),i}}}export{se as A,te as _};
