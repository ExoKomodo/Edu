var P=Object.defineProperty;var U=(c,e,n)=>e in c?P(c,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):c[e]=n;var E=(c,e,n)=>(U(c,typeof e!="symbol"?e+"":e,n),n);import{d as I,u as T,b as q,p as V,k as l,o as m,f as u,q as _,v as k,a,t as b,g as h,m as C,s as M,x as v,l as w,y as F,F as $,h as D,j as N,A as p,z as y,H as g,D as B}from"./index-3492b608.js";import{S as j}from"./SectionService-15405545.js";import{B as H}from"./BlobService-93622bdb.js";const z={key:0,class:"bg-mysticStone text-white border-slate-400 border-2 rounded p-1 pl-2 my-2"},L=a("div",{class:"text-2xl"},"Assignment Editor",-1),O={for:"edit-mode"},K=a("label",{for:"show-preview"}," Show preview?",-1),R={key:0},Z=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-12"},"Name",-1),G={key:0,class:"text-2xl font-bold border-slate-400 rounded border-2 p-1 pl-2"},J=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 p my-2 mr-1"},"Short Description",-1),Q={key:1,class:"text-xl border-slate-400 rounded border-2 p-1 pl-2 my-2"},W=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-8"},"Problem Explanation",-1),X=["innerHTML"],Y=a("label",{for:"required-sections"},"Choose required sections:",-1),ee=["value"],te=a("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-12"},"Id",-1),re=I({__name:"AssignmentEditor",props:{handler:{type:Function},handlerText:{},assignmentId:{},assignmentName:{},assignmentDescription:{},assignmentProblemExplanation:{},assignmentSectionIds:{}},async setup(c){let e,n;const s=N(),i=T(),d=c,t=q({isEditMode:!1,showPreview:!1,id:d.assignmentId,name:d.assignmentName,description:d.assignmentDescription,problemExplanation:d.assignmentProblemExplanation,requiredSectionIds:d.assignmentSectionIds}),x=([e,n]=V(async()=>j.getAllAsync({toast:i,token:([e,n]=V(()=>p.getAccessTokenAsync(s,{toast:i})),e=await e,n(),e)})),e=await e,n(),e);return(A,r)=>{var f;return l(p).isAdmin(l(s))?(m(),u("div",z,[L,_(a("input",{type:"checkbox",id:"edit-mode",name:"editMode","onUpdate:modelValue":r[0]||(r[0]=o=>t.isEditMode=o)},null,512),[[k,t.isEditMode]]),a("label",O,b(A.handlerText)+" mode?",1),a("span",{class:M(["inline-block",{invisible:!t.isEditMode}])},[h(C,{handler:()=>A.handler(t),text:A.handlerText},null,8,["handler","text"])],2),a("div",{class:M({invisible:!t.isEditMode})},[_(a("input",{type:"checkbox",id:"show-preview",name:"showPreview","onUpdate:modelValue":r[1]||(r[1]=o=>t.showPreview=o)},null,512),[[k,t.showPreview]]),K],2),l(p).isAdmin(l(s))&&t.isEditMode?(m(),u("div",R,[Z,h(v,{modelValue:t.name,"onUpdate:modelValue":r[2]||(r[2]=o=>t.name=o),height:2},null,8,["modelValue"]),l(p).isAdmin(l(s))&&t.isEditMode&&t.showPreview?(m(),u("p",G,b((f=t.name)==null?void 0:f.toUpperCase()),1)):w("",!0),J,h(v,{modelValue:t.description,"onUpdate:modelValue":r[3]||(r[3]=o=>t.description=o),height:2},null,8,["modelValue"]),l(p).isAdmin(l(s))&&t.isEditMode&&t.showPreview?(m(),u("p",Q,b(t.description),1)):w("",!0),W,h(v,{modelValue:t.problemExplanation,"onUpdate:modelValue":r[4]||(r[4]=o=>t.problemExplanation=o),language:"html",height:40},null,8,["modelValue"]),l(p).isAdmin(l(s))&&t.isEditMode&&t.showPreview?(m(),u("div",{key:2,class:"text-xl border-slate-400 rounded border-2 p-1 pl-2 my-2",innerHTML:t.problemExplanation},null,8,X)):w("",!0),a("div",null,[Y,_(a("select",{id:"required-sections",name:"required-sections",class:"h-10","onUpdate:modelValue":r[5]||(r[5]=o=>t.requiredSectionIds=o),multiple:""},[(m(!0),u($,null,D(l(x),([o,S])=>(m(),u("option",{value:o,class:"text-black"},b(S.name),9,ee))),256))],512),[[F,t.requiredSectionIds]])]),te,h(v,{modelValue:t.id,"onUpdate:modelValue":r[6]||(r[6]=o=>t.id=o),height:2},null,8,["modelValue"])])):w("",!0)])):w("",!0)}}});class ae{constructor(){E(this,"objectViewKeys",[{key:"id",kind:"text"}])}make(){return new y({})}static async createAsync(e,n={}){var s;try{return new y(await g.postAsync("assignment",e,n))}catch(i){throw(s=n.toast)==null||s.error(`Failed to create assignment: ${i}`),i}}static async deleteAsync(e,n={}){var s;try{return new y(await g.deleteAsync("assignment",e,n))}catch(i){throw(s=n.toast)==null||s.error(`Failed to delete assignment: ${i}`),i}}static async fillTemplateAsync(e,n={}){if(!e)return"";const s=/"\${([0-9a-zA-Z_\-\/\.]+)}"/g,i=new Map;for(let d of e.matchAll(s)){const t=d[0],x=d[1];t in i||i.set(t,await H.getPresignedUrlAsync(x,n))}for(let[d,t]of i)e=e.replace(d,t);return e}static async getAsync(e,n={}){var s;try{return new y(await g.getAsync("assignment",e,n))}catch(i){throw(s=n.toast)==null||s.error(`Failed to get assignment: ${i}`),i}}static async getAllAsync(e={}){var n;try{let s=await g.getAllAsync("assignment",e);return Object.keys(s).forEach(function(i,d){s[i]=new B(s[i])}),s=new Map(Object.entries(s)),s}catch(s){throw(n=e.toast)==null||n.error(`Failed to get all assignments: ${s}`),s}}static async updateAsync(e,n={}){var s;try{return new y(await g.putAsync("assignment",e,n))}catch(i){throw(s=n.toast)==null||s.error(`Failed to update assignment: ${i}`),i}}}export{ae as A,re as _};
