import{H as m,d as T,u as E,b as P,m as U,j as l,o as p,f as h,n as g,v as C,a as d,t as x,g as y,l as $,p as _,C as A,k as w,i as F,A as u}from"./index-3fc7e24a.js";import{B as H}from"./BlobService-b6957b08.js";class f{static async createAsync(o,s={}){var t;try{return await m.postAsync("course",o,s)}catch(r){throw(t=s.toast)==null||t.error(`Failed to create course: ${r}`),r}}static async deleteAsync(o,s={}){var t;try{return await m.deleteAsync("course",o,s)}catch(r){throw(t=s.toast)==null||t.error(`Failed to delete course: ${r}`),r}}static async fillTemplateAsync(o,s={}){if(!o)return"";const t=/"\${([0-9a-zA-Z_\-\/\.]+)}"/g,r=new Map;for(let n of o.matchAll(t)){const e=n[0],v=n[1];e in r||r.set(e,await H.getPresignedUrlAsync(v,s))}for(let[n,e]of r)o=o.replace(n,e);return o}static async getAsync(o,s={}){var t,r;try{const n=await m.getAsync("course",o,s);try{n.templatedContent=await f.fillTemplateAsync(n.content,s)}catch(e){throw(t=s.toast)==null||t.error(`Failed to fill template for course content: ${e}`),e}return n}catch(n){throw(r=s.toast)==null||r.error(`Failed to get course: ${n}`),n}}static async getAllAsync(o={}){var s;try{return await m.getAllAsync("course",o)}catch(t){throw(s=o.toast)==null||s.error(`Failed to get all courses: ${t}`),t}}static async updateAsync(o,s={}){var t;try{return await m.putAsync("course",o,s)}catch(r){throw(t=s.toast)==null||t.error(`Failed to update course: ${r}`),r}}}const N={key:0,class:"bg-mysticStone text-white border-slate-400 border-2 rounded p-1 pl-2 my-2"},S=d("div",{class:"text-2xl"},"Course Editor",-1),B={for:"edit-mode"},D=d("label",{for:"show-preview"}," Show preview?",-1),L={key:0},I=d("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-12"},"Name",-1),z={key:0,class:"text-2xl font-bold border-slate-400 rounded border-2 p-1 pl-2"},j=d("div",{class:"text-white border-white border-2 rounded p-1 pl-2 p my-2 mr-1"},"Description",-1),R=["innerHTML"],Z=d("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-8"},"Content",-1),q=["innerHTML"],G=d("div",{class:"text-white border-white border-2 rounded p-1 pl-2 my-2 mr-12"},"Id",-1),O=T({__name:"CourseEditor",props:{handler:{type:Function},handlerText:{},courseId:{},courseName:{},courseDescription:{},courseContent:{}},async setup(V){let o,s;const t=F(),r=E(),n=V,e=P({isEditMode:!1,showPreview:!1,id:n.courseId,name:n.courseName,description:n.courseDescription,content:n.courseContent,templatedContent:n.courseContent}),v=([o,s]=U(()=>u.getAccessTokenAsync(t,{toast:r})),o=await o,s(),o);async function k(c){c.target.checked&&(e.templatedContent=await f.fillTemplateAsync(e.content,{toast:r,token:v}))}async function M(c){e.showPreview&&(e.templatedContent=await f.fillTemplateAsync(e.content,{toast:r,token:v}))}return(c,a)=>{var b;return l(u).isAdmin(l(t))?(p(),h("div",N,[S,g(d("input",{type:"checkbox",id:"edit-mode",name:"editMode","onUpdate:modelValue":a[0]||(a[0]=i=>e.isEditMode=i)},null,512),[[C,e.isEditMode]]),d("label",B,x(c.handlerText)+" mode?",1),d("span",{class:_(["inline-block",{invisible:!e.isEditMode}])},[y($,{handler:()=>c.handler(e),text:c.handlerText},null,8,["handler","text"])],2),d("div",{class:_({invisible:!e.isEditMode})},[g(d("input",{type:"checkbox",id:"show-preview",onChange:k,name:"showPreview","onUpdate:modelValue":a[1]||(a[1]=i=>e.showPreview=i)},null,544),[[C,e.showPreview]]),D],2),l(u).isAdmin(l(t))&&e.isEditMode?(p(),h("div",L,[I,y(A,{modelValue:e.name,"onUpdate:modelValue":a[2]||(a[2]=i=>e.name=i),height:2},null,8,["modelValue"]),l(u).isAdmin(l(t))&&e.isEditMode&&e.showPreview?(p(),h("p",z,x((b=e.name)==null?void 0:b.toUpperCase()),1)):w("",!0),j,y(A,{modelValue:e.description,"onUpdate:modelValue":a[3]||(a[3]=i=>e.description=i),height:2},null,8,["modelValue"]),l(u).isAdmin(l(t))&&e.isEditMode&&e.showPreview?(p(),h("p",{key:1,class:"text-xl border-slate-400 rounded border-2 p-1 pl-2 my-2",innerHTML:e.description},null,8,R)):w("",!0),Z,y(A,{modelValue:e.content,"onUpdate:modelValue":[a[4]||(a[4]=i=>e.content=i),M],language:"html",height:40},null,8,["modelValue"]),l(u).isAdmin(l(t))&&e.isEditMode&&e.showPreview?(p(),h("div",{key:2,class:"text-xl border-slate-400 rounded border-2 p-1 pl-2 my-2",innerHTML:e.templatedContent},null,8,q)):w("",!0),G,y(A,{modelValue:e.id,"onUpdate:modelValue":a[5]||(a[5]=i=>e.id=i),height:2},null,8,["modelValue"])])):w("",!0)])):w("",!0)}}});export{f as C,O as _};
